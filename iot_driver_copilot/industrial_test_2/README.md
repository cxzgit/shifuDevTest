Industrial Environmental Sensor Modbus RTU to HTTP Driver (C++)

Overview
- Connects to a Modbus RTU environmental sensor over RS-485 (9600 baud, 8N1) and polls holding registers via function code 0x03.
- Exposes an HTTP interface with two endpoints to fetch driver status and latest sensor readings.
- Implements protocol conversion and a background polling loop with timeouts, retries, and exponential backoff.

Build
- Requires a C++17-capable toolchain on Linux (for POSIX serial and sockets).
- Build command:
  g++ -std=c++17 driver.cpp -o driver

Run
- Configure via environment variables (no hard-coded values). Then start the driver:
  HTTP_HOST=0.0.0.0 HTTP_PORT=8080 SERIAL_PORT=/dev/ttyUSB0 SERIAL_BAUD=9600 MODBUS_SLAVE_ID=1 REG_TEMP_ADDR=0 REG_HUM_ADDR=1 REG_CO2_ADDR=2 POLL_INTERVAL_MS=1000 READ_TIMEOUT_MS=500 BACKOFF_INITIAL_MS=500 BACKOFF_MAX_MS=10000 TEMP_SCALE=1 HUM_SCALE=1 CO2_SCALE=1 ./driver

Environment Variables
- HTTP_HOST: IP/host to bind the HTTP server (e.g., 0.0.0.0)
- HTTP_PORT: Port for the HTTP server (e.g., 8080)
- SERIAL_PORT: Serial device path for RS-485 (e.g., /dev/ttyUSB0)
- SERIAL_BAUD: Baud rate (default 9600)
- MODBUS_SLAVE_ID: Modbus slave/unit ID of the sensor (default 1)
- REG_TEMP_ADDR: Holding register address for temperature (default 0)
- REG_HUM_ADDR: Holding register address for humidity (default 1)
- REG_CO2_ADDR: Holding register address for CO2 (default 2)
- TEMP_SCALE: Scale factor applied to raw temp register (default 1.0)
- HUM_SCALE: Scale factor applied to raw humidity register (default 1.0)
- CO2_SCALE: Scale factor applied to raw CO2 register (default 1.0)
- POLL_INTERVAL_MS: Polling interval in milliseconds (default 1000)
- READ_TIMEOUT_MS: Serial read timeout in milliseconds (default 500)
- BACKOFF_INITIAL_MS: Initial retry backoff in milliseconds (default 500)
- BACKOFF_MAX_MS: Maximum retry backoff in milliseconds (default 10000)

HTTP API
- GET /status
  Returns JSON with connection and polling status: serial_connected, serial_port, slave_id, baud, polling_active, poll_interval_ms, last_poll_time.
  Example:
    curl -s http://localhost:8080/status

- GET /readings
  Returns JSON with latest sensor readings (temperature, humidity, co2) and timestamps per value, plus last_poll_time.
  Example:
    curl -s http://localhost:8080/readings

Notes
- The driver polls one register for each data point. If your device uses different addresses, set the REG_*_ADDR variables accordingly. If scaling is required (e.g., raw value needs conversion), set TEMP_SCALE, HUM_SCALE, and CO2_SCALE.
- Implements exponential backoff when the device or serial port is not available. The buffer is thread-safe and serves the most recent values.

Generated by [IoT Driver Copilot](https://copilot.test.shifu.dev/)

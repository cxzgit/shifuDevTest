Industrial Environmental Sensor Modbus RTU to HTTP Driver (C++)

Overview
- This driver connects to an industrial environmental sensor using Modbus RTU (RS-485, 9600 8N1), periodically polls specified holding registers (function code 0x03), and exposes the latest parsed readings over a simple HTTP server.
- Endpoints:
  - GET /status: Returns connection and polling status
  - GET /readings: Returns latest temperature, humidity, and CO2 readings (with timestamps)

Requirements
- Linux environment (POSIX serial via termios)
- g++ (C++17)

Build
- Compile into a single binary:
  g++ -std=c++17 -O2 -pthread driver.cpp serial_port.cpp modbus_rtu.cpp http_server.cpp -o driver

Run
- All configuration comes from environment variables (no hard-coded defaults). You must set each variable before running.

Required Environment Variables
- HTTP_HOST: Host/IP for HTTP server to bind (e.g., 0.0.0.0)
- HTTP_PORT: Port for HTTP server (e.g., 8000)
- SERIAL_PORT: Serial device path (e.g., /dev/ttyUSB0)
- MODBUS_SLAVE_ID: Modbus slave ID of the sensor (e.g., 1)
- REG_TEMPERATURE: Holding register address for temperature (e.g., 0)
- REG_HUMIDITY: Holding register address for humidity (e.g., 1)
- REG_CO2: Holding register address for CO2 (e.g., 2)
- SCALE_TEMPERATURE: Scale applied to raw register value for temperature (e.g., 0.1)
- SCALE_HUMIDITY: Scale applied to raw register value for humidity (e.g., 0.1)
- SCALE_CO2: Scale applied to raw register value for CO2 (e.g., 1.0)
- POLL_INTERVAL_MS: Polling interval in milliseconds (e.g., 1000)
- MODBUS_TIMEOUT_MS: Per-request Modbus timeout in milliseconds (e.g., 1000)
- BACKOFF_INITIAL_MS: Initial backoff delay on errors in milliseconds (e.g., 500)
- BACKOFF_MAX_MS: Maximum backoff delay on errors in milliseconds (e.g., 10000)

Notes
- Serial configuration is fixed to 9600 baud, 8 data bits, no parity, 1 stop bit (8N1) as per device spec.
- Each data point is read as a single 16-bit holding register and scaled via the provided SCALE_ variables.
- The driver maintains a background polling loop with timeout, retries via exponential backoff, and logs key events to stderr.

Example
- Run (example values shown):
  export HTTP_HOST=0.0.0.0
  export HTTP_PORT=8000
  export SERIAL_PORT=/dev/ttyUSB0
  export MODBUS_SLAVE_ID=1
  export REG_TEMPERATURE=0
  export REG_HUMIDITY=1
  export REG_CO2=2
  export SCALE_TEMPERATURE=0.1
  export SCALE_HUMIDITY=0.1
  export SCALE_CO2=1.0
  export POLL_INTERVAL_MS=1000
  export MODBUS_TIMEOUT_MS=1000
  export BACKOFF_INITIAL_MS=500
  export BACKOFF_MAX_MS=10000
  ./driver

- Test endpoints:
  curl -s http://127.0.0.1:8000/status | jq
  curl -s http://127.0.0.1:8000/readings | jq

Security and Safety
- No external process execution.
- Thread-safe buffers for latest readings and status.
- Graceful shutdown on SIGINT/SIGTERM.

Generated by [IoT Driver Copilot](https://copilot.test.shifu.dev/)

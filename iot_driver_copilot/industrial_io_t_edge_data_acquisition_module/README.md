Industrial IoT Edge Data Acquisition Module HTTP Driver (Modbus TCP to HTTP)

Overview
- This driver connects to the Industrial IoT Edge Data Acquisition Module using its native Modbus TCP protocol, continuously polls input channels, and exposes a minimal HTTP API for consumption by browsers and CLI tools.
- It performs protocol conversion (Modbus TCP â†’ HTTP/JSON) and maintains a resilient background collection loop with timeout, retry, and exponential backoff.

Requirements
- Node.js 16+ (recommended 18+)
- Network reachability to the device over Modbus TCP

Environment Variables
- HTTP_HOST: HTTP server bind address (default: 0.0.0.0)
- HTTP_PORT: HTTP server port (default: 8080)
- MODBUS_HOST: Device IP or hostname (required)
- MODBUS_PORT: Modbus TCP port (default: 502)
- MODBUS_ID: Modbus Unit ID/Slave ID (default: 1)
- READ_TIMEOUT_MS: Per-request timeout in milliseconds (default: 1000)
- POLL_INTERVAL_MS: Background polling interval in milliseconds (default: 100)
- BACKOFF_MIN_MS: Minimum reconnect backoff in milliseconds (default: 500)
- BACKOFF_MAX_MS: Maximum reconnect backoff in milliseconds (default: 10000)
- ANALOG_CHANNELS: Number of analog input channels (default: 8)
- ANALOG_REG_START: Starting register address for analog inputs (default: 0)
- ANALOG_REG_TYPE: Register type for analog inputs: INPUT (FC4) or HOLDING (FC3). Default: INPUT
- DIGITAL_INPUT_COUNT: Number of digital input channels (default: 4)
- DIGITAL_INPUT_START: Starting address for digital inputs (default: 0)
- ANALOG_SCALE: Optional comma-separated per-channel scale factors for analog inputs (length = ANALOG_CHANNELS). Default: 1 for all
- ANALOG_OFFSET: Optional comma-separated per-channel offsets for analog inputs (length = ANALOG_CHANNELS). Default: 0 for all

Install & Run
1) Install dependencies
   npm install

2) Set environment variables (example)
   export MODBUS_HOST=192.168.1.50
   export HTTP_PORT=8080
   export POLL_INTERVAL_MS=100

3) Start the driver
   npm start

HTTP API
- GET /inputs/analog
  - Returns the latest analog samples from all channels
  - Example:
    curl "http://localhost:8080/inputs/analog"

- GET /inputs/analog?channel_id=N
  - Returns the latest analog sample for channel N (0-based)
  - Example:
    curl "http://localhost:8080/inputs/analog?channel_id=3"

- GET /status
  - Returns module and driver status (reachability, configuration, last update timestamp)
  - Example:
    curl "http://localhost:8080/status"

Notes
- This driver polls the device using Modbus TCP and never exposes native protocol URLs.
- It implements automatic reconnection with exponential backoff and timestamps every update.
- Values returned for analog inputs are the raw register values optionally scaled/offset via environment variables.

Generated by [IoT Driver Copilot](https://copilot.test.shifu.dev/)

Industrial IoT Edge Data Acquisition Module (DAQ-2000) HTTP Driver

Description
- This Golang driver connects to a Modbus device (TCP or RTU) and exposes an HTTP endpoint to read data. It continuously polls the device in the background with retry and exponential backoff, keeping a thread-safe cache of the latest sample for fast HTTP responses.

Requirements
- Go 1.21+
- Network access to the Modbus device (for TCP)
- Serial access to the RS-485 port (for RTU)

Environment Variables (required)
- HTTP_HOST: HTTP server listen host, e.g. 0.0.0.0
- HTTP_PORT: HTTP server port, e.g. 8080
- MODBUS_PROTOCOL: tcp or rtu
- If MODBUS_PROTOCOL=tcp:
  - MODBUS_TCP_HOST: Modbus TCP host/IP
  - MODBUS_TCP_PORT: Modbus TCP port (e.g., 502)
- If MODBUS_PROTOCOL=rtu:
  - MODBUS_RTU_SERIAL_PORT: Serial device path (e.g., /dev/ttyUSB0)
  - MODBUS_RTU_BAUD: Baud rate (e.g., 9600)
  - MODBUS_RTU_PARITY: N, E, or O
  - MODBUS_RTU_STOP_BITS: 1 or 2
  - MODBUS_RTU_DATA_BITS: 7 or 8
- MODBUS_SLAVE_ID: Target slave/unit id (0-255)
- MODBUS_TABLE: coil | discrete | input | holding
- MODBUS_ADDRESS: Start address to read
- MODBUS_QUANTITY: Number of points/registers to read (1-125)
- MODBUS_TIMEOUT_MS: Request timeout in milliseconds
- POLL_INTERVAL_MS: Background polling interval in milliseconds
- RETRY_MAX: Max consecutive retries before a cool-off (integer)
- RETRY_BASE_BACKOFF_MS: Base backoff in milliseconds
- RETRY_MAX_BACKOFF_MS: Max backoff in milliseconds

Run
- Set the environment variables above
- Run: go run .

HTTP API
- GET /modbus/read
  - Without query parameters: returns the latest cached sample from background polling
  - With query parameters: performs a one-shot live read using provided connection parameters
  - Query parameters for live read:
    - protocol: tcp | rtu
    - For tcp: host, port
    - For rtu: serial_port, baud, parity (N|E|O), stop_bits (1|2), data_bits (7|8)
    - Common: slave_id, table (coil|discrete|input|holding), address, quantity, timeout_ms

Examples
- Cached read: curl "http://localhost:8080/modbus/read"
- Live TCP read: curl "http://localhost:8080/modbus/read?protocol=tcp&host=192.168.1.10&port=502&slave_id=1&table=holding&address=0&quantity=10&timeout_ms=2000"
- Live RTU read: curl "http://localhost:8080/modbus/read?protocol=rtu&serial_port=/dev/ttyUSB0&baud=9600&parity=N&stop_bits=1&data_bits=8&slave_id=1&table=coil&address=0&quantity=16&timeout_ms=2000"

Notes
- The driver maintains connection health, automatic retries with exponential backoff, and logs key events.
- Only the explicitly required endpoint (/modbus/read) is implemented.

Generated by [IoT Driver Copilot](https://copilot.test.shifu.dev/)
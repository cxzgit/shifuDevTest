Industrial Environmental Sensor Modbus RTU → HTTP Driver (Golang)

Overview
- Connects to an RS-485 Modbus RTU environmental sensor (temperature, humidity, CO₂) using Function Code 0x03 (Read Holding Registers).
- Periodically polls configured holding registers and exposes the latest readings over an HTTP endpoint.
- Implements a resilient background collection loop with timeout, retry, and exponential backoff, and maintains a thread-safe buffer for fast responses.

HTTP API
- GET /readings
  - Returns JSON with temperature, humidity, co2, and updated_at (RFC3339). Returns 503 with {"error":"not connected"} if no successful poll has occurred.

Example response
{
  "temperature": 23.5,
  "humidity": 45.2,
  "co2": 650,
  "updated_at": "2025-01-01T12:00:00Z"
}

Environment Variables
- HTTP_HOST: HTTP server bind host (default: 0.0.0.0)
- HTTP_PORT: HTTP server port (default: 8080)
- SERIAL_PORT: Serial device path, e.g., /dev/ttyUSB0 (required)
- BAUD_RATE: Serial baud rate (default: 9600)
- DATA_BITS: Serial data bits (default: 8)
- STOP_BITS: Serial stop bits (default: 1)
- PARITY: Serial parity: N, E, or O (default: N)
- MODBUS_SLAVE_ID: Modbus RTU slave/unit ID (default: 1)
- REG_TEMP: Holding register address for temperature (required)
- REG_HUM: Holding register address for humidity (required)
- REG_CO2: Holding register address for CO₂ (required)
- SCALE_TEMP: Scale factor applied to raw temperature (default: 1.0)
- SCALE_HUM: Scale factor applied to raw humidity (default: 1.0)
- SCALE_CO2: Scale factor applied to raw CO₂ (default: 1.0)
- TEMP_SIGNED: Interpret temperature register as signed (true/false, default: true)
- HUM_SIGNED: Interpret humidity register as signed (true/false, default: true)
- CO2_SIGNED: Interpret CO₂ register as signed (true/false, default: false)
- POLL_INTERVAL_MS: Polling interval in milliseconds (default: 1000)
- READ_TIMEOUT_MS: Serial read timeout in milliseconds (default: 500)
- BACKOFF_BASE_MS: Base backoff delay in milliseconds (default: 500)
- BACKOFF_MAX_MS: Maximum backoff delay in milliseconds (default: 15000)

Build and Run
1) Ensure you have Go installed (1.20+).
2) Set environment variables appropriately.
3) Build:
   go build -o driver
4) Run:
   ./driver

Quick Test
- Example curl (adjust host/port as needed):
  curl http://127.0.0.1:8080/readings

Notes
- The driver actively polls the device and serves the latest sample via HTTP. It does not expose or redirect to any Modbus URLs.
- If the serial connection fails, the driver logs errors, retries with exponential backoff, and reconnects once available.

Generated by [IoT Driver Copilot](https://copilot.test.shifu.dev/)
Industrial IoT Edge Data Acquisition Module HTTP Driver (Modbus TCP)

Overview
- This driver connects to the device via its native Modbus TCP protocol, continuously collects analog input data, and exposes a minimal HTTP API to serve the latest values as JSON.
- It implements a resilient background collection loop with timeout, retry, and exponential backoff, and maintains a thread-safe buffer storing the latest sample.

HTTP API
- GET /status
  - Returns JSON with driver health and connection information.
  - Example:
    curl -s http://localhost:8080/status | jq
- GET /analog
  - Query params:
    - channels: comma-separated indices (0-based). Optional; defaults to all channels.
    - include_ts: boolean; if true, includes a timestamp of the last sample.
  - Examples:
    - All channels: curl -s "http://localhost:8080/analog"
    - Channels 0,1 with timestamp: curl -s "http://localhost:8080/analog?channels=0,1&include_ts=true"

Configuration (Environment Variables)
- HTTP_HOST: HTTP bind host. Default: 0.0.0.0
- HTTP_PORT: HTTP bind port. Default: 8080
- MODBUS_TCP_ADDR: Device address host:port. Default: 127.0.0.1:502
- MODBUS_UNIT_ID: Modbus Unit/Slave ID (0–247). Default: 1
- MODBUS_TIMEOUT_MS: Per-request timeout in milliseconds. Default: 2000
- POLL_INTERVAL_MS: Data polling interval in milliseconds. Default: 1000
- BACKOFF_INITIAL_MS: Initial reconnect backoff in milliseconds. Default: 1000
- BACKOFF_MAX_MS: Maximum reconnect backoff in milliseconds. Default: 15000
- ANALOG_BASE_ADDR: Starting Modbus holding register address for analog inputs (zero-based). Default: 0
- ANALOG_COUNT: Number of analog input channels. Default: 8
- ANALOG_REG_WIDTH: Register width per channel in bits (16 or 32). Default: 16
- ANALOG_ENDIAN: Endianness for 32-bit values: big or little. Default: big
- ANALOG_SIGNED: If true, interpret 16-bit values as signed int16. Default: false
- ANALOG_SCALE: Divisor to scale raw integer values into engineering units (value = raw / ANALOG_SCALE). Default: 1000.0

Notes
- The driver uses Modbus holding registers (function code 0x03) for analog inputs. Configure ANALOG_BASE_ADDR and related parameters to match your device register map.
- Digital inputs/outputs are not exposed by this driver as API endpoints; only the explicitly required endpoints are implemented.

Run
1) Ensure your device’s Modbus TCP server is reachable and set the appropriate environment variables.
2) Build and run:
   go mod download
   go build -o driver
   ./driver

Examples
- Basic run (localhost device):
  MODBUS_TCP_ADDR=127.0.0.1:502 ANALOG_BASE_ADDR=0 ANALOG_COUNT=8 ./driver
- Custom interval and scaling:
  POLL_INTERVAL_MS=200 ANALOG_SCALE=1000 MODBUS_TCP_ADDR=192.168.1.50:502 ./driver

Security
- Place this driver on a trusted network segment or behind an HTTP proxy with authentication if needed. This driver does not implement authentication.

Generated by [IoT Driver Copilot](https://copilot.test.shifu.dev/)

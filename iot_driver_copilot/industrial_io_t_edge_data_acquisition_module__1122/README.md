IoT HTTP Driver for Advantech DAQ-2000 (Industrial IoT edge data acquisition module 1122)

Overview
- This driver connects to the device using its native protocols (Modbus TCP, optional MQTT) and runs a lightweight HTTP server to expose status diagnostics.
- Real-time Modbus data acquisition is performed in the background at a configurable interval (≤ 1000 ms), with automatic error detection, reconnection using exponential backoff, and structured logging.
- RS-485/Modbus RTU link status is reported as not available by this driver (no serial port dependency). Modbus register read/write operations are implemented internally.

Run
- Ensure a Java runtime (JDK 8+).
- Set environment variables as described below.
- Start the driver:
  java Main

Environment Variables (required unless marked optional)
- HTTP_HOST: HTTP server bind host, e.g. 0.0.0.0
- HTTP_PORT: HTTP server port, e.g. 8080
- MODBUS_TCP_HOST: Device Modbus TCP host/IP
- MODBUS_TCP_PORT: Device Modbus TCP port (typically 502)
- MODBUS_UNIT_ID: Modbus Unit ID (slave id)
- MODBUS_TIMEOUT_MS: Modbus TCP socket timeout in milliseconds
- ACQ_INTERVAL_MS: Acquisition interval in milliseconds (must be ≤ 1000)
- BACKOFF_INITIAL_MS: Initial reconnect backoff in milliseconds
- BACKOFF_MAX_MS: Maximum reconnect backoff in milliseconds
- MODBUS_READ_AI_START: Start address for Input Registers (analog inputs)
- MODBUS_READ_AI_COUNT: Number of Input Registers to read per cycle
- MODBUS_READ_DI_START: Start address for Discrete Inputs (digital inputs)
- MODBUS_READ_DI_COUNT: Number of Discrete Inputs to read per cycle
- MQTT_HOST (optional): MQTT broker host; enable MQTT connectivity when set
- MQTT_PORT (optional, required if MQTT_HOST set): MQTT broker port
- MQTT_CLIENT_ID (optional, required if MQTT_HOST set): MQTT client ID
- MQTT_USERNAME (optional): MQTT username
- MQTT_PASSWORD (optional): MQTT password
- MQTT_KEEPALIVE_SEC (optional, required if MQTT_HOST set): MQTT keepalive seconds

HTTP API
- GET /status
  Returns overall device health and comms state (JSON): Ethernet/RS-485 link, Modbus TCP/RTU availability, MQTT connection state, acquisition enabled flag, current acquisition interval, and last error info.

Example
- Start driver (example):
  HTTP_HOST=0.0.0.0 HTTP_PORT=8080 MODBUS_TCP_HOST=192.168.1.10 MODBUS_TCP_PORT=502 MODBUS_UNIT_ID=1 MODBUS_TIMEOUT_MS=2000 ACQ_INTERVAL_MS=1000 BACKOFF_INITIAL_MS=500 BACKOFF_MAX_MS=5000 MODBUS_READ_AI_START=0 MODBUS_READ_AI_COUNT=8 MODBUS_READ_DI_START=0 MODBUS_READ_DI_COUNT=8 java Main

- Query status:
  curl http://localhost:8080/status

Notes
- The driver does not expose native device protocol URLs; it converts device-native protocols to an HTTP status interface.
- Structured logs are printed to stdout/stderr with timestamps and event fields.

Generated by [IoT Driver Copilot](https://copilot.test.shifu.dev/)
